(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[1],{79:function(e,t,a){"use strict";a.r(t);var s=a(2),c=a.n(s),n=a(3),o=a(15),i=a(26),l=a(8),r=a(1),d=a(6),u=a(7),j=a(25),b=a(27),m=a(85),O=a.n(m),p=a(0),f=a(28),h=a(82),g=a(83),x=(a(4),a(5),function(e){var t=new WebSocket("".concat("https:"===window.location.protocol?"wss":"ws","://localhost:4000/ws/task?token=").concat(localStorage.getItem("token").split('"')[1]));return t.onopen=function(e){console.log(" websocket is open")},t.onclose=function(){console.log("wesocket ios closed"),t=new WebSocket("ws://localhost:4000/ws/task?token=".concat(localStorage.getItem("token").split('"')[1]))},t.onerror=function(){console.log("wesocket error"),t=new WebSocket("ws://localhost:4000/ws/task?token=".concat(localStorage.getItem("token").split('"')[1]))},t}());t.default=function(){var e=Object(r.useState)(""),t=Object(l.a)(e,2),a=t[0],s=t[1],m=Object(r.useState)({}),v=Object(l.a)(m,2),N=v[0],w=v[1],S=Object(r.useState)({}),k=Object(l.a)(S,2),_=(k[0],k[1]),y=Object(r.useState)({}),D=Object(l.a)(y,2),T=D[0],I=D[1],C=Object(r.useState)({assignees:[]}),A=Object(l.a)(C,2),E=A[0],F=A[1],J=Object(r.useState)([]),P=Object(l.a)(J,2),M=P[0],G=P[1],q=Object(r.useRef)(null),z=Object(r.useContext)(j.a),L=Object(l.a)(z,2),W=L[0],B=(L[1],Object(r.useContext)(b.a)),H=B.projects,R=B.dispatchProject,U=(B.projectStore,B.setProjectStore,Object(d.h)()),$=U.space_id,K=U.project_id,Q=U.task_id,V=Object(d.f)();Object(r.useEffect)((function(){var e=W.find((function(e){return String(e._id===String($))})),t=H.find((function(e){return String(e._id)===String(K)}));if(t){var a=[t.workspace.default_statuses].concat(Object(i.a)(t.workspace.custom_statuses)).find((function(e){return String(e._id)===String(t.active_status_template)}));a&&I(a)}return e&&G(e.members),"undefined"!==Q?Object(f.c)({_id:Q}).then((function(e){F(Object(o.a)(Object(o.a)({},e),{},{updated_by:JSON.parse(localStorage.getItem("user"))._id,updated_at:new Date(Date.now()).toISOString()}))})):F({assignees:[],created_at:new Date(Date.now()).toISOString(),created_by:JSON.parse(localStorage.getItem("user"))._id,workspace:$,project:K,status:T.statuses?T.statuses[0]:""}),function(){}}),[,H,T,f.c,R,M,G,F]),Object(r.useEffect)(Object(n.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(x),x.onmessage=function(e){var t=JSON.parse(e.data);console.log(t),"ASSIGNEE_ADD"===t.action&&(console.log(t.data),console.log("add"))},e.abrupt("return",(function(){}));case 3:case"end":return e.stop()}}),e)}))),[x.onmessage]);var X=function(e){var t=e.target?e.target.name:void 0,a={};if("name"===t&&(a[t]=e.target.value,F(Object(o.a)(Object(o.a)({},E),a))),"due_date"===t&&(a[t]=e.target.value,F(Object(o.a)(Object(o.a)({},E),a))),"status"===t){a[t]=JSON.parse(e.target.value);var s=Object(o.a)(Object(o.a)({},E),a);F(s)}if("assignees"===t){var c=e.target.selectedOptions,n=Array.from(c).map((function(e){return e.value})),l={members:n};0!=E.assignees.length&&(a[t]=Array.from(new Set([].concat(Object(i.a)(E.assignees.map((function(e){return e._id}))),Object(i.a)(n)))),l.members=Array.from(new Set([].concat(Object(i.a)(E.assignees.map((function(e){return e._id}))),Object(i.a)(n)))),F(Object(o.a)(Object(o.a)(Object(o.a)({},E),a),l))),a[t]=Array.from(new Set(Object(i.a)(n))),F(Object(o.a)(Object(o.a)(Object(o.a)({},E),a),l))}},Y=function(e){return console.log(e),function(e){var t=!1;return e.hasOwnProperty("Delete Task")&&"del"===e["Delete Task"]?w({}):e.hasOwnProperty("Delete Task")&&"del"!==e["Delete Task"]&&(w({"Delete Task":"Invalid! Enter Lowercase del"}),t=!0),t}(e)},Z=function(){var e=Object(n.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==Object.keys(N).length){e.next=4;break}return e.next=3,Object(f.a)({_id:Q});case 3:V.push(Object(u.a)().TaskMenu.urlPathText({space_id:$,project_id:K}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("section",{className:"task col my-4 p-2 ",style:{position:"relative"},children:[Object(p.jsxs)("div",{className:"task-header row justify-content-between",children:[Object(p.jsxs)("div",{className:"p-1 col",children:[Object(p.jsx)("span",{className:"fw-light",children:"Status:"}),E.status?Object(p.jsxs)("span",{style:{color:E.status.color},children:[" ",E.status.status]}):""]}),Object(p.jsx)("div",{className:"p-1 col",children:Object(p.jsxs)("div",{className:"dropdown mx-2 ",children:[Object(p.jsxs)("button",{className:"dropbtn fw-light ",children:["Assignees of task ",Object(p.jsx)("i",{className:"fas fa-caret-down"})]}),Object(p.jsx)("ul",{className:"dropdown-content w-100 ",children:E.assignees?E.assignees.map((function(e,t){return Object(p.jsxs)("li",{className:" fw-light",children:[e.name,Object(p.jsx)("i",{className:"fas fa-user-times text-danger float-right p-1",onClick:function(){!function(e){x.send(JSON.stringify({action:"ASSIGNEE_ADD",data:E}));var t={assignees:E.assignees.filter((function(t){return String(t._id)!=String(e)}))};F(Object(o.a)(Object(o.a)({},E),{},{assignees:t.assignees,members:t.assignees})),Object(f.e)(Object(o.a)(Object(o.a)({},E),{},{assignees:t.assignees})).then((function(e){console.log(e)})),V.push(Object(u.a)().TaskForm.urlPathText({space_id:$,project_id:K,task_id:Q}))}(e._id)},role:"button"})]},t)})):Object(p.jsx)("li",{className:"fw-light ",children:"Assign members   "})})]})}),Object(p.jsxs)("div",{className:"p-1 col-md-4 col-sm-12",children:[Object(p.jsx)("span",{className:"fw-light",children:"Date created:"}),Object(p.jsxs)("span",{children:[" ",new Date(E.created_at).toUTCString()," "]})]})]}),Object(p.jsxs)("div",{className:"task-body row",children:[Object(p.jsxs)("form",{className:"col px-4",id:"taskform",encType:"multipart/form-data",onSubmit:function(e){e.preventDefault(),Object(f.e)(E).then((function(e){console.log(e)})),x.send(JSON.stringify({action:"ASSIGNEE_ADD",data:E})),V.push(Object(u.a)().TaskMenu.urlPathText({space_id:$,project_id:K,task_id:Q}))},children:[Object(p.jsx)("p",{children:"Tags: Bug, Sprint22"}),Object(p.jsxs)("div",{className:"row justify-content-between align-items-start",children:[Object(p.jsxs)("div",{className:"col mb-3",children:[Object(p.jsx)("label",{className:"input-group-text fw-light",htmlFor:"",children:" Task Name"}),Object(p.jsx)("input",{type:"text",name:"name",className:"mb-3 w-100",value:E.name?E.name:"",placeholder:"task name",onChange:X,required:!0})]}),Object(p.jsxs)("div",{className:"col mb-3",children:[Object(p.jsx)("label",{className:"input-group-text fw-light",htmlFor:"",children:" Due date:"}),Object(p.jsx)("input",{className:"w-100",type:"datetime-local",name:"due_date",value:E.due_date?new Date(E.due_date).toISOString().split(".")[0]:"",onChange:X})]})]}),Object(p.jsxs)("div",{className:"row justify-content-between align-items-start",children:[Object(p.jsxs)("div",{className:"col mb-3",children:[Object(p.jsx)("label",{className:"input-group-text fw-light",htmlFor:"",children:" Select Members to Assign:"}),Object(p.jsx)("select",{className:"form-select",id:"",name:"assignees",size:"3",multiple:!0,onChange:X,children:M?M.map((function(e,t){return Object(p.jsx)("option",{value:e._id,children:e.name},t)})):""})]}),Object(p.jsxs)("div",{className:"col mb-3",children:[Object(p.jsxs)("label",{className:"input-group-text fw-light text-capitalize",htmlFor:"inputGroupSelect01",children:[" ",T?T.name:""]}),Object(p.jsx)("select",{className:"custom-select",id:"inputGroupSelect01",name:"status",onChange:X,required:!0,children:T.statuses?T.statuses.map((function(e,t){return Object(p.jsx)("option",{value:JSON.stringify(e),style:{color:e.color},children:e.status},t)})):""})]}),Object(p.jsx)("div",{className:"col-12 mb-3",children:Object(p.jsx)(O.a,{ref:q,value:E.description?E.description:"",config:{readonly:!1,placeholder:"Start typing task here....",name:"editor"},tabIndex:1,onBlur:function(e){F(Object(o.a)(Object(o.a)({},E),{},{description:e}))}})})]}),Object(p.jsx)("div",{className:""}),Object(p.jsx)("input",{type:"submit",className:"p-1",value:"Save"})]}),Object(p.jsxs)("span",{className:"",style:{bottom:"0",right:"0",width:"100px",position:"absolute",zIndex:1},children:["undefined"!==Q&&Object(p.jsx)(g.a,{className:"m-2 btn btn-outline-danger p-1",modalFormId:"task",text:"Delete",onClick:function(){_({name:""}),s("Delete this Task")}}),Object(p.jsx)(h.a,{modalFormId:"task",onSubmit:function(e){Z(e)},modalTitle:a,inputData:{"Delete Task":""},placeholders:{"Delete Task":"type del"},errors:N,isError:function(e){return Y(e)}})]})]})]})})}},82:function(e,t,a){"use strict";var s=a(15),c=a(8),n=a(1),o=(a(84),a(0));t.a=function(e){var t=e.modalTitle,a=e.onSubmit,i=e.inputData,l=e.modalFormId,r=e.placeholders,d=void 0===r?{}:r,u=e.errors,j=void 0===u?{}:u,b=e.isError,m=void 0!==b&&b,O=Object(n.useState)(i),p=Object(c.a)(O,2),f=p[0],h=p[1],g=function(e){var t=e.target.id,a={};"active_status_template"!==t&&(a[t]=e.target.value,h(Object(s.a)(Object(s.a)({},f),a))),"active_status_template"==t&&(a[t]=e.target.selectedOptions[0].value,h(Object(s.a)(Object(s.a)({},f),a)))};Object(n.useEffect)((function(){h(i)}),[i]);var x=function(){window.$("#".concat(l)).modal("hide")};return Object(o.jsx)("div",{children:Object(o.jsx)("div",{className:"modal fade ",id:l,tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(o.jsx)("div",{className:"modal-dialog modal-dialog-centered",children:Object(o.jsxs)("div",{className:"modal-content",children:[Object(o.jsxs)("div",{className:"modal-header",children:[Object(o.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:t}),Object(o.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(o.jsx)("div",{className:"modal-body",children:Object(o.jsxs)("form",{onSubmit:function(e){e.preventDefault(),"function"===typeof m&&m(f)||(a(f),x())},className:"needs-validation",children:[Object.entries(i).map((function(e,t){var a=Object(c.a)(e,2),s=a[0],n=a[1],i=null;return i="active_status_template"==s?Object(o.jsxs)("select",{className:"form-select",id:s,name:"active_status_template",onChange:g,required:!0,children:[Object(o.jsx)("option",{value:"",className:"fw-light",children:"please select"}),n.map((function(e,t){var a=e._id,s=e.name;return 0==t?Object(o.jsxs)("option",{value:a,children:[" ",s+t]}):Object(o.jsx)("option",{value:a,children:s+t})}))]}):Object(o.jsx)("input",{type:"text",className:"form-control ",id:s,placeholder:d[s]?d[s]:"",value:f[s],onChange:g,required:!0}),Object(o.jsxs)("div",{className:"mb-3",children:[Object(o.jsx)("label",{htmlFor:"text",className:"col-form-label",style:{textTransform:"capitalize"},children:s}),i,Object(o.jsx)("div",{className:"text-danger form-text",children:j[s]?j[s]:""}),Object(o.jsx)("div",{className:"invalid-feedback",children:"Please choose a username."})]},t)})),Object(o.jsx)("div",{className:"mb-2 d-flex justify-content-end",children:Object(o.jsx)("button",{type:"submit",className:" ml-auto",children:"Save"})})]})})]})})})})}},83:function(e,t,a){"use strict";var s=a(0);t.a=function(e){var t=e.text,a=e.onClick,c=e.color,n=e.modalFormId,o=e.className;return Object(s.jsx)("button",{dangerouslySetInnerHTML:{__html:t},onClick:a,type:"button",className:"p-1 "+o,"data-bs-toggle":"modal","data-bs-target":"#"+n,style:{color:c}})}}}]);
//# sourceMappingURL=1.89a6cf29.chunk.js.map
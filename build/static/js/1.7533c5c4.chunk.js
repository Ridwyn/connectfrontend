(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[1],{83:function(e,t,a){"use strict";a.r(t);var s=a(2),c=a.n(s),n=a(3),i=a(13),r=a(27),l=a(6),o=a(1),d=a(7),j=a(8),u=a(26),b=a(28),m=a(87),O=a.n(m),p=a(0),f=a(29),h=a(84),g=a(85),x=a(38);t.default=function(){var e=Object(o.useState)(""),t=Object(l.a)(e,2),a=t[0],s=t[1],m=Object(o.useState)({}),v=Object(l.a)(m,2),N=v[0],S=v[1],_=Object(o.useState)({}),w=Object(l.a)(_,2),y=(w[0],w[1]),k=Object(o.useState)({}),D=Object(l.a)(k,2),T=D[0],I=D[1],C=Object(o.useState)({assignees:[]}),A=Object(l.a)(C,2),E=A[0],F=A[1],J=Object(o.useState)([]),P=Object(l.a)(J,2),M=P[0],G=P[1],q=Object(o.useRef)(null),z=Object(o.useContext)(u.a),L=Object(l.a)(z,2),B=L[0],H=(L[1],Object(o.useContext)(b.a)),R=H.projects,U=H.dispatchProject,$=(H.projectStore,H.setProjectStore,Object(d.h)()),K=$.space_id,Q=$.project_id,V=$.task_id,W=Object(d.f)();Object(o.useEffect)((function(){var e=B.find((function(e){return String(e._id===String(K))})),t=R.find((function(e){return String(e._id)===String(Q)}));if(t){var a=[t.workspace.default_statuses].concat(Object(r.a)(t.workspace.custom_statuses)).find((function(e){return String(e._id)===String(t.active_status_template)}));a&&I(a)}return e&&G(e.members),"undefined"!==V?Object(f.c)({_id:V}).then((function(e){F(Object(i.a)(Object(i.a)({},e),{},{updated_by:JSON.parse(localStorage.getItem("user"))._id,updated_at:new Date(Date.now()).toISOString()}))})):F({assignees:[],created_at:new Date(Date.now()).toISOString(),created_by:JSON.parse(localStorage.getItem("user"))._id,workspace:K,project:Q,status:T.statuses?T.statuses[0]:""}),function(){}}),[,R,T,f.c,U,M,G,F]),Object(o.useEffect)(Object(n.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(x.a),x.a.onmessage=function(e){var t=JSON.parse(e.data);console.log(t),"ASSIGNEE_ADD"===t.action&&(console.log(t.data),console.log("add"))},e.abrupt("return",(function(){}));case 3:case"end":return e.stop()}}),e)}))),[x.a.onmessage]);var X=function(e){var t=e.target?e.target.name:void 0,a={};if("name"===t&&(a[t]=e.target.value,F(Object(i.a)(Object(i.a)({},E),a))),"due_date"===t&&(a[t]=e.target.value,F(Object(i.a)(Object(i.a)({},E),a))),"status"===t){a[t]=JSON.parse(e.target.value);var s=Object(i.a)(Object(i.a)({},E),a);F(s)}if("assignees"===t){var c=e.target.selectedOptions,n=Array.from(c).map((function(e){return e.value})),l={members:n};0!=E.assignees.length&&(a[t]=Array.from(new Set([].concat(Object(r.a)(E.assignees.map((function(e){return e._id}))),Object(r.a)(n)))),l.members=Array.from(new Set([].concat(Object(r.a)(E.assignees.map((function(e){return e._id}))),Object(r.a)(n)))),F(Object(i.a)(Object(i.a)(Object(i.a)({},E),a),l))),a[t]=Array.from(new Set(Object(r.a)(n))),F(Object(i.a)(Object(i.a)(Object(i.a)({},E),a),l))}},Y=function(e){return console.log(e),function(e){var t=!1;return e.hasOwnProperty("Delete Task")&&"del"===e["Delete Task"]?S({}):e.hasOwnProperty("Delete Task")&&"del"!==e["Delete Task"]&&(S({"Delete Task":"Invalid! Enter Lowercase del"}),t=!0),t}(e)},Z=function(){var e=Object(n.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==Object.keys(N).length){e.next=4;break}return e.next=3,Object(f.a)({_id:V});case 3:W.push(Object(j.a)().TaskMenu.urlPathText({space_id:K,project_id:Q}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("section",{className:"task col my-4 p-2 ",style:{position:"relative"},children:[Object(p.jsxs)("div",{className:"task-header row justify-content-between",children:[Object(p.jsxs)("div",{className:"p-1 col",children:[Object(p.jsx)("span",{className:"fw-light",children:"Status:"}),E.status?Object(p.jsxs)("span",{style:{color:E.status.color},children:[" ",E.status.status]}):""]}),Object(p.jsx)("div",{className:"p-1 col",children:Object(p.jsxs)("div",{className:"dropdown mx-2 ",children:[Object(p.jsxs)("button",{className:"dropbtn fw-light ",children:["Assignees of task ",Object(p.jsx)("i",{className:"fas fa-caret-down"})]}),Object(p.jsx)("ul",{className:"dropdown-content w-100 ",children:E.assignees?E.assignees.map((function(e,t){return Object(p.jsxs)("li",{className:" fw-light",children:[e.name,Object(p.jsx)("i",{className:"fas fa-user-times text-danger float-right p-1",onClick:function(){!function(e){x.a.send(JSON.stringify({action:"ASSIGNEE_ADD",data:E}));var t={assignees:E.assignees.filter((function(t){return String(t._id)!=String(e)}))};F(Object(i.a)(Object(i.a)({},E),{},{assignees:t.assignees,members:t.assignees})),Object(f.e)(Object(i.a)(Object(i.a)({},E),{},{assignees:t.assignees})).then((function(e){console.log(e)})),W.push(Object(j.a)().TaskForm.urlPathText({space_id:K,project_id:Q,task_id:V}))}(e._id)},role:"button"})]},t)})):Object(p.jsx)("li",{className:"fw-light ",children:"Assign members   "})})]})}),Object(p.jsxs)("div",{className:"p-1 col-md-4 col-sm-12",children:[Object(p.jsx)("span",{className:"fw-light",children:"Date created:"}),Object(p.jsxs)("span",{children:[" ",new Date(E.created_at).toUTCString()," "]})]})]}),Object(p.jsxs)("div",{className:"task-body row",children:[Object(p.jsxs)("form",{className:"col px-4",id:"taskform",encType:"multipart/form-data",onSubmit:function(e){e.preventDefault(),Object(f.e)(E).then((function(e){console.log(e)})),x.a.send(JSON.stringify({action:"ASSIGNEE_ADD",data:E})),W.push(Object(j.a)().TaskMenu.urlPathText({space_id:K,project_id:Q,task_id:V}))},children:[Object(p.jsx)("p",{children:"Tags: Bug, Sprint22"}),Object(p.jsxs)("div",{className:"row justify-content-between align-items-start",children:[Object(p.jsxs)("div",{className:"col mb-3",children:[Object(p.jsx)("label",{className:"input-group-text fw-light",htmlFor:"",children:" Task Name"}),Object(p.jsx)("input",{type:"text",name:"name",className:"mb-3 w-100",value:E.name?E.name:"",placeholder:"task name",onChange:X,required:!0})]}),Object(p.jsxs)("div",{className:"col mb-3",children:[Object(p.jsx)("label",{className:"input-group-text fw-light",htmlFor:"",children:" Due date:"}),Object(p.jsx)("input",{className:"w-100",type:"datetime-local",name:"due_date",value:E.due_date?new Date(E.due_date).toISOString().split(".")[0]:"",onChange:X})]})]}),Object(p.jsxs)("div",{className:"row justify-content-between align-items-start",children:[Object(p.jsxs)("div",{className:"col mb-3",children:[Object(p.jsx)("label",{className:"input-group-text fw-light",htmlFor:"",children:" Select Members to Assign:"}),Object(p.jsx)("select",{className:"form-select",id:"",name:"assignees",size:"3",multiple:!0,onChange:X,children:M?M.map((function(e,t){return Object(p.jsx)("option",{value:e._id,children:e.name},t)})):""})]}),Object(p.jsxs)("div",{className:"col mb-3",children:[Object(p.jsxs)("label",{className:"input-group-text fw-light text-capitalize",htmlFor:"inputGroupSelect01",children:[" ",T?T.name:""]}),Object(p.jsx)("select",{className:"custom-select",id:"inputGroupSelect01",name:"status",onChange:X,required:!0,children:T.statuses?T.statuses.map((function(e,t){return Object(p.jsx)("option",{value:JSON.stringify(e),style:{color:e.color},children:e.status},t)})):""})]}),Object(p.jsx)("div",{className:"col-12 mb-3",children:Object(p.jsx)(O.a,{ref:q,value:E.description?E.description:"",config:{readonly:!1,placeholder:"Start typing task here....",name:"editor"},tabIndex:1,onBlur:function(e){F(Object(i.a)(Object(i.a)({},E),{},{description:e}))}})})]}),Object(p.jsx)("div",{className:""}),Object(p.jsx)("input",{type:"submit",className:"p-1",value:"Save"})]}),Object(p.jsxs)("span",{className:"",style:{bottom:"0",right:"0",width:"100px",position:"absolute",zIndex:1},children:["undefined"!==V&&Object(p.jsx)(g.a,{className:"m-2 btn btn-outline-danger p-1",modalFormId:"task",text:"Delete",onClick:function(){y({name:""}),s("Delete this Task")}}),Object(p.jsx)(h.a,{modalFormId:"task",onSubmit:function(e){Z(e)},modalTitle:a,inputData:{"Delete Task":""},placeholders:{"Delete Task":"type del"},errors:N,isError:function(e){return Y(e)}})]})]})]})})}},84:function(e,t,a){"use strict";var s=a(13),c=a(6),n=a(1),i=(a(86),a(0));t.a=function(e){var t=e.modalTitle,a=e.onSubmit,r=e.inputData,l=e.modalFormId,o=e.placeholders,d=void 0===o?{}:o,j=e.errors,u=void 0===j?{}:j,b=e.isError,m=void 0!==b&&b,O=Object(n.useState)(r),p=Object(c.a)(O,2),f=p[0],h=p[1],g=function(e){var t=e.target.id,a={};"active_status_template"!==t&&(a[t]=e.target.value,h(Object(s.a)(Object(s.a)({},f),a))),"active_status_template"==t&&(a[t]=e.target.selectedOptions[0].value,h(Object(s.a)(Object(s.a)({},f),a)))};Object(n.useEffect)((function(){h(r)}),[r]);var x=function(){window.$("#".concat(l)).modal("hide")};return Object(i.jsx)("div",{children:Object(i.jsx)("div",{className:"modal fade ",id:l,tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(i.jsx)("div",{className:"modal-dialog modal-dialog-centered",children:Object(i.jsxs)("div",{className:"modal-content",children:[Object(i.jsxs)("div",{className:"modal-header",children:[Object(i.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:t}),Object(i.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(i.jsx)("div",{className:"modal-body",children:Object(i.jsxs)("form",{onSubmit:function(e){e.preventDefault(),"function"===typeof m&&m(f)||(a(f),x())},className:"needs-validation",children:[Object.entries(r).map((function(e,t){var a=Object(c.a)(e,2),s=a[0],n=a[1],r=null;return r="active_status_template"==s?Object(i.jsxs)("select",{className:"form-select",id:s,name:"active_status_template",onChange:g,required:!0,children:[Object(i.jsx)("option",{value:"",className:"fw-light",children:"please select"}),n.map((function(e,t){var a=e._id,s=e.name;return 0==t?Object(i.jsxs)("option",{value:a,children:[" ",s+t]}):Object(i.jsx)("option",{value:a,children:s+t})}))]}):Object(i.jsx)("input",{type:"text",className:"form-control ",id:s,placeholder:d[s]?d[s]:"",value:f[s],onChange:g,required:!0}),Object(i.jsxs)("div",{className:"mb-3",children:[Object(i.jsx)("label",{htmlFor:"text",className:"col-form-label",style:{textTransform:"capitalize"},children:s}),r,Object(i.jsx)("div",{className:"text-danger form-text",children:u[s]?u[s]:""}),Object(i.jsx)("div",{className:"invalid-feedback",children:"Please choose a username."})]},t)})),Object(i.jsx)("div",{className:"mb-2 d-flex justify-content-end",children:Object(i.jsx)("button",{type:"submit",className:" ml-auto",children:"Save"})})]})})]})})})})}},85:function(e,t,a){"use strict";var s=a(0);t.a=function(e){var t=e.text,a=e.onClick,c=e.color,n=e.modalFormId,i=e.className;return Object(s.jsx)("button",{dangerouslySetInnerHTML:{__html:t},onClick:a,type:"button",className:"p-1 "+i,"data-bs-toggle":"modal","data-bs-target":"#"+n,style:{color:c}})}}}]);
//# sourceMappingURL=1.7533c5c4.chunk.js.map
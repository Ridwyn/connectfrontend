{"version":3,"sources":["components/task/TaskForm.js","components/ModalForm.js","components/ModalButton.js"],"names":["TaskForm","useState","modalTitle","setModalTitle","errors","setErrors","setFormData","statusTemplate","setStatusTemplate","assignees","taskFormData","setTaskFormData","spaceMembers","setSpaceMembers","editor","useRef","useContext","SpaceContext","spaces","ProjectContext","projects","dispatchProject","projectStore","setProjectStore","useParams","space_id","project_id","task_id","history","useHistory","useEffect","space","find","String","_id","project","temp","workspace","default_statuses","custom_statuses","status","active_status_template","members","getTaskItem","then","data","updated_by","JSON","parse","localStorage","getItem","updated_at","Date","now","toISOString","created_at","created_by","statuses","a","console","log","ws","onmessage","event","res","action","changeFormData","e","key","target","name","undefined","value","newTaskFormData","selectedOpts","selectedOptions","values","Array","from","map","length","Set","assignee","handleFormSubmit","preventDefault","saveTask","connect","send","stringify","push","RouterPaths","TaskMenu","urlPathText","handleIsErrorCheck","submittedData","obj","bol","hasOwnProperty","checkLeaveDeleteInput","handleTaskDelete","Object","keys","deleteTaskItem","className","style","position","color","index","onClick","assignee_id","filter","removeAssignee","role","toUTCString","id","encType","onSubmit","htmlFor","type","placeholder","onChange","required","due_date","split","size","multiple","member","ref","description","config","readonly","tabIndex","onBlur","content","bottom","right","width","zIndex","ModalButton","modalFormId","text","ModalForm","inputData","placeholders","isError","stateInputData","setStateInputData","changeInput","closeModal","window","$","modal","entries","element","dangerouslySetInnerHTML","__html"],"mappings":"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","file":"static/js/1.baa15192.chunk.js","sourcesContent":["import React,{useState, useRef,useContext, useEffect,useCallback} from 'react'\r\nimport { useParams, useHistory } from 'react-router-dom';\r\nimport RouterPaths from '../RouterPaths';\r\nimport { SpaceContext , httpSpaceAction} from \"../../context/SpaceContext\"\r\nimport { ProjectContext,httpProjectAction} from \"../../context/ProjectContext\"\r\nimport JoditEditor from \"jodit-react\"; \r\nimport TaskCommentForm from './TaskCommentForm';\r\nimport {saveTask,getTaskItem,deleteTaskItem,sseTaskUpdate} from '../../actions/task'\r\nimport ModalForm from '../ModalForm'\r\nimport ModalButton from '../ModalButton'\r\nimport {ws} from '../../actions/websocket'\r\n\r\nconst TaskForm = () => {\r\n\r\n  const[modalTitle,setModalTitle]=useState('');\r\n  const [errors,setErrors]=useState({})\r\n  const [formData,setFormData] = useState({});\r\n  const [statusTemplate,setStatusTemplate] = useState({})\r\n  const [taskFormData,setTaskFormData]= useState({assignees:[]});\r\n  const [spaceMembers,setSpaceMembers]= useState([]);\r\n  const editor = useRef(null);\r\n  const [spaces,dispatchSpace]= useContext(SpaceContext);\r\n  const {projects,dispatchProject,projectStore,setProjectStore}= useContext(ProjectContext);\r\n  const {space_id,project_id,task_id} = useParams();\r\n  const history = useHistory();\r\n\r\n\r\n  \r\n\r\n\r\n  useEffect (()=>{\r\n\r\n   \r\n    \r\n    const space = spaces.find(space => String(space._id === String(space_id)))\r\n    const project = projects.find(project => String(project._id)===String(project_id))\r\n\r\n    if (project) {\r\n      const allStatuses=[project.workspace.default_statuses,...project.workspace.custom_statuses]\r\n      const temp =allStatuses.find(status=> String(status._id) === String(project.active_status_template))\r\n      if (temp) {\r\n      setStatusTemplate(temp)\r\n      }\r\n    }\r\n\r\n    if (space) {\r\n      setSpaceMembers(space.members)\r\n    }\r\n\r\n    \r\n    // Check if task is new or needs update\r\n    if (task_id!=='undefined') {\r\n      getTaskItem({_id:task_id}).then((data=>{\r\n        setTaskFormData({\r\n          ...data,\r\n          updated_by:JSON.parse(localStorage.getItem('user'))._id,\r\n          updated_at:(new Date(Date.now() )).toISOString()\r\n        })\r\n      }))\r\n    }else{\r\n      setTaskFormData({\r\n        // ...taskFormData,\r\n        assignees:[],\r\n        created_at:(new Date(Date.now() )).toISOString(),\r\n        created_by:JSON.parse(localStorage.getItem('user'))._id,\r\n        workspace:space_id,\r\n        project:project_id,\r\n        status:statusTemplate.statuses?statusTemplate.statuses[0]: ''\r\n      })\r\n    }\r\n\r\n    \r\n    // WHEN COMPONENT UNMOUNTS\r\n    return()=>{\r\n      // sseTaskUpdate({task_id:'',start:''})\r\n    }\r\n\r\n  },[,projects,statusTemplate,getTaskItem,dispatchProject,spaceMembers,setSpaceMembers,setTaskFormData])\r\n\r\n\r\n\r\n  // //WEBSOCKET TRANSACTIONS\r\n  useEffect(async () => {\r\n\r\n\r\n    console.log(ws)\r\n  \r\n\r\n      ws.onmessage=(event)=>{\r\n      let res = JSON.parse(event.data)\r\n      console.log(res)\r\n      if (res.action ==='ASSIGNEE_ADD') {\r\n          console.log(res.data);\r\n          console.log('add')\r\n      }\r\n    }\r\n  \r\n    return () => {\r\n      \r\n    }\r\n  }, [ws.onmessage])\r\n  \r\n  \r\n \r\n\r\n  const config = {\r\n\t\treadonly: false, // all options from https://xdsoft.net/jodit/doc/\r\n    placeholder: 'Start typing task here....',\r\n    name:'editor'\r\n\t}\r\n\r\n  const changeFormData = (e)=>{\r\n\r\n    // console.log(e);\r\n    let key = e.target ? e.target.name: undefined ;\r\n    let data ={};\r\n    if (key ==='name') {\r\n      data[key]=e.target.value\r\n      setTaskFormData({...taskFormData,...data})\r\n    }\r\n    if (key ==='due_date') {\r\n      data[key]=e.target.value\r\n      setTaskFormData({...taskFormData,...data})\r\n    }\r\n    if (key ==='status') {\r\n      data[key]=JSON.parse(e.target.value)\r\n      const newTaskFormData={...taskFormData,...data}\r\n      setTaskFormData(newTaskFormData);\r\n    }\r\n    if (key ==='assignees') {\r\n      let selectedOpts=e.target.selectedOptions\r\n      const values= Array.from(selectedOpts).map(({ value }) => value);\r\n\r\n      const members ={'members':values}\r\n      \r\n      if (taskFormData.assignees.length !=0) {\r\n         data[key]=Array.from(new Set([...taskFormData.assignees.map(assignee=>{return assignee._id}), ...values]));\r\n          members.members=Array.from(new Set([...taskFormData.assignees.map(assignee=>{return assignee._id}), ...values]));\r\n         setTaskFormData({...taskFormData,...data,...members})\r\n      }\r\n      data[key]=Array.from(new Set([...values]));\r\n      setTaskFormData({...taskFormData,...data,...members})\r\n    }\r\n\r\n  }\r\n\r\n  // After submitting the task\r\n  const handleFormSubmit =async(e)=>{\r\n    e.preventDefault();\r\n\r\n   saveTask(taskFormData).then((data)=>{console.log(data)})\r\n\r\n  //  WEBSOCKET\r\n    console.log(ws.connect())\r\n   ws.send(JSON.stringify({action:'ASSIGNEE_ADD',data:taskFormData}))\r\n  //  history.push(RouterPaths().TaskForm.urlPathText({space_id:space_id,project_id:project_id,task_id:task_id}))\r\n   history.push(RouterPaths().TaskMenu.urlPathText({space_id:space_id,project_id:project_id,task_id:task_id}))\r\n  }\r\n\r\n  const removeAssignee = (assignee_id) =>{\r\n        // WEBSOCKET\r\n        ws.send(JSON.stringify({action:'ASSIGNEE_ADD',data:taskFormData}))\r\n\r\n    // Filter the assignee and transform the taskform data\r\n    let data={assignees:taskFormData.assignees.filter(assignee=>(String(assignee._id ))!= String(assignee_id))}\r\n    setTaskFormData({...taskFormData,assignees:data.assignees,members:data.assignees})\r\n\r\n    saveTask({...taskFormData,assignees:data.assignees}).then((data)=>{console.log(data)})\r\n    history.push(RouterPaths().TaskForm.urlPathText({space_id:space_id,project_id:project_id,task_id:task_id}))\r\n \r\n  }\r\n\r\n  const checkLeaveDeleteInput=(obj)=>{\r\n    let bol=false;\r\n    if (obj.hasOwnProperty('Delete Task') && obj['Delete Task'] === 'del') {\r\n        setErrors({})            \r\n    }else if(obj.hasOwnProperty('Delete Task') && obj['Delete Task'] !== 'del'){\r\n        setErrors({'Delete Task':'Invalid! Enter Lowercase del'})\r\n        bol=true;\r\n    }\r\n    return bol\r\n  }\r\n\r\n  const handleIsErrorCheck =(submittedData)=>{\r\n    console.log(submittedData)\r\n    return checkLeaveDeleteInput  (submittedData);\r\n    \r\n  }\r\n  \r\n  const handleTaskDelete = async(data) =>{\r\n    \r\n    if (Object.keys(errors).length === 0) {\r\n      await deleteTaskItem({_id:task_id})\r\n      history.push(RouterPaths().TaskMenu.urlPathText({space_id:space_id,project_id:project_id}))\r\n\r\n    }\r\n  }\r\n\r\n\r\n    return (\r\n        <>\r\n        <section className=\"task col my-4 p-2 \" style={{position:'relative'}}>\r\n          <div className=\"task-header row justify-content-between\">\r\n            <div className=\"p-1 col\">\r\n              <span className=\"fw-light\">Status:</span>\r\n              {\r\n                taskFormData.status ?\r\n                <span style={{color:taskFormData.status.color}}> {taskFormData.status.status}</span>\r\n                :''\r\n              }\r\n            </div>\r\n\r\n            <div className=\"p-1 col\">\r\n              <div className=\"dropdown mx-2 \">\r\n                <button className=\"dropbtn fw-light \">Assignees of task <i className=\"fas fa-caret-down\"></i></button>\r\n                <ul className=\"dropdown-content w-100 \">\r\n                  {\r\n                    taskFormData.assignees ?\r\n                    (taskFormData.assignees.map((assignee,index)=>\r\n                    (<li className=\" fw-light\" key={index}>\r\n                      {assignee.name} \r\n                    <i className=\"fas fa-user-times text-danger float-right p-1\" onClick={()=>{removeAssignee(assignee._id)}} role=\"button\"></i>\r\n                    </li>)))\r\n                    :(<li className=\"fw-light \">Assign members   </li>)\r\n\r\n                  }\r\n                </ul>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"p-1 col-md-4 col-sm-12\">\r\n              <span className=\"fw-light\">Date created:</span>\r\n              <span> {(new Date(taskFormData.created_at )).toUTCString()} </span>\r\n            </div>\r\n\r\n          </div> \r\n\r\n          <div className=\"task-body row\">\r\n            \r\n            <form className=\"col px-4\" id=\"taskform\" encType=\"multipart/form-data\" onSubmit={handleFormSubmit}>\r\n                <p>Tags:\r\n                  Bug, Sprint22\r\n                </p>\r\n\r\n                <div className=\"row justify-content-between align-items-start\">\r\n                  <div className=\"col mb-3\">\r\n                    <label className=\"input-group-text fw-light\" htmlFor=\"\"> Task Name</label>\r\n                      <input type=\"text\" name=\"name\" className=\"mb-3 w-100\" value={taskFormData.name ? taskFormData.name :''} placeholder=\"task name\"\r\n                      onChange={changeFormData} required/>\r\n                  </div>\r\n\r\n\r\n                  <div className=\"col mb-3\">\r\n                      <label className=\"input-group-text fw-light\" htmlFor=\"\"> Due date:</label>\r\n                      <input className=\"w-100\" type=\"datetime-local\" name=\"due_date\" value={taskFormData.due_date ? (new Date(taskFormData.due_date)).toISOString().split('.')[0] :''} onChange={changeFormData} />\r\n                   </div>\r\n\r\n                </div>\r\n                <div className=\"row justify-content-between align-items-start\">\r\n                    <div className=\"col mb-3\">\r\n                      <label className=\"input-group-text fw-light\" htmlFor=\"\"> Select Members to Assign:</label>\r\n                      \r\n                      <select className=\"form-select\"  id=\"\" name=\"assignees\" size=\"3\" multiple onChange={changeFormData}> \r\n                      {\r\n                        spaceMembers?\r\n                        spaceMembers.map((member,index)=>(\r\n                          <option value={member._id} key={index} >\r\n                             {member.name}\r\n                          </option>\r\n                        ))\r\n                        :''\r\n\r\n                      }           \r\n                      </select> \r\n                    </div>\r\n\r\n                  \r\n\r\n                    <div className=\"col mb-3\">\r\n                      <label className=\"input-group-text fw-light text-capitalize\" htmlFor=\"inputGroupSelect01\"> {statusTemplate? statusTemplate.name :''}</label>\r\n                      <select className=\"custom-select\" id=\"inputGroupSelect01\" name=\"status\" onChange={changeFormData} required>\r\n                        {\r\n                          statusTemplate.statuses?\r\n                          statusTemplate.statuses.map((status,index)=>(\r\n                            <option value={JSON.stringify(status)} style={{color:status.color}} key={index}>\r\n                               {status.status}\r\n                            </option>\r\n                          ))\r\n                          :''\r\n                        }\r\n                          \r\n                      </select> \r\n                    </div>\r\n\r\n                    <div className=\"col-12 mb-3\">\r\n                      <JoditEditor\r\n                              ref={editor}\r\n                              value={taskFormData.description ? taskFormData.description :''}\r\n                              config={config}\r\n                              tabIndex={1} // tabIndex of textarea\r\n                              onBlur={(content)=>{ \r\n                                setTaskFormData({...taskFormData,description:content})\r\n                              }} // preferred to use only this option to update the content for performance reasons\r\n                              // onChange={(content)=>{setTaskFormData({...taskFormData,description:content})}}\r\n                          />\r\n                    </div>\r\n                </div>\r\n\r\n\r\n           \r\n\r\n              {/* <div className=\"my-3\">\r\n                <label className=\"fw-light\">Attachments/files: </label>\r\n                <input multiple=\"\" type=\"file\" name=\"attachments\"/>\r\n              </div> */}\r\n\r\n              <div className=''>\r\n                \r\n\r\n              </div>\r\n              \r\n              <input  type=\"submit\" className='p-1'    value=\"Save\"/>\r\n            </form>\r\n\r\n              <span className='' \r\n              style={{bottom:'0', right:'0', width:'100px', position:'absolute', zIndex:1}}\r\n              >\r\n                {\r\n                  task_id !== 'undefined' &&\r\n                  <ModalButton className='m-2 btn btn-outline-danger p-1' modalFormId='task' text='Delete' onClick={()=>{setFormData({name:''});setModalTitle('Delete this Task')}}/>                                    \r\n                }\r\n                \r\n                <ModalForm  modalFormId='task' onSubmit={(data)=>{ handleTaskDelete(data)}} modalTitle={modalTitle} inputData={{'Delete Task':''}} placeholders={{'Delete Task': 'type del'}} errors={errors} isError={(submittedData)=>{return handleIsErrorCheck(submittedData)}}/>\r\n\r\n\r\n              </span>\r\n\r\n               \r\n\r\n          </div>\r\n\r\n        </section>       \r\n        \r\n        </>\r\n    )}\r\n\r\n\r\n\r\nexport default TaskForm","import PropTypes from 'prop-types'\r\nimport { useState ,useEffect} from 'react';\r\nimport * as $ from \"jquery\";\r\n\r\n\r\nconst ModalForm = ({modalTitle,onSubmit,inputData,modalFormId,placeholders={},errors={},isError=false}) => {\r\n    const [stateInputData, setStateInputData] = useState(inputData);\r\n\r\n    const changeInput=(e)=>{\r\n        let key = e.target.id;\r\n        let data ={};\r\n       \r\n       \r\n        \r\n        \r\n        if (key !=='active_status_template') {\r\n            data[key]=e.target.value\r\n            setStateInputData({...stateInputData,...data})\r\n        }\r\n        if (key =='active_status_template') {\r\n            data[key]=e.target.selectedOptions[0].value\r\n            setStateInputData({...stateInputData,...data})\r\n        }\r\n        \r\n\r\n       \r\n    }\r\n    \r\n    // Run Once only when inputdata from param comes in\r\n    useEffect(()=>{\r\n        setStateInputData(inputData);\r\n    },[inputData])\r\n\r\n    const closeModal=()=>{\r\n        // Using Jquery to close Boostrap Modal\r\n        window.$(`#${modalFormId}`).modal('hide');\r\n    }\r\n\r\n   \r\n    \r\n  \r\n    const handleSubmit=(e)=>{\r\n        e.preventDefault();\r\n        if (typeof isError === 'function' ) {\r\n            if (!isError(stateInputData) ) {\r\n                onSubmit(stateInputData)\r\n                closeModal(); \r\n            }  \r\n        }else{\r\n            onSubmit(stateInputData)\r\n                closeModal();\r\n        }\r\n           \r\n\r\n    }\r\n  \r\n    \r\n\r\n    return (\r\n        <div>\r\n           \r\n            <div  className='modal fade ' id={modalFormId} tabIndex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\r\n            <div className=\"modal-dialog modal-dialog-centered\">\r\n                <div className=\"modal-content\">\r\n                <div className=\"modal-header\">  \r\n                    <h5 className=\"modal-title\" id=\"exampleModalLabel\">{modalTitle}</h5>\r\n                    <button type=\"button\" className=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                </div>\r\n                <div className=\"modal-body\">\r\n                    <form onSubmit={handleSubmit} className=\"needs-validation\" >\r\n                        {\r\n                            \r\n                            Object.entries(inputData).map(([key,value], index)=>{\r\n                                let element=null;\r\n                                if (key=='active_status_template') {\r\n                                   element =<select className=\"form-select\" id={key} name=\"active_status_template\" onChange={changeInput} required>\r\n                                        <option value='' className='fw-light'>please select</option>\r\n                                        {\r\n                                            value.map(({_id,name},key)=>(\r\n                                                \r\n                                               key==0 ? <option  value={_id}> { name + key}</option>:\r\n                                                <option value={_id}>{name+ key}</option>\r\n                                            ))\r\n                                        }\r\n                                        </select> \r\n                                 }else{\r\n                                     element=<input type=\"text\" className=\"form-control \" id={key} \r\n                                     placeholder={placeholders[key]?placeholders[key]:''}\r\n                                     value={stateInputData[key]} onChange={changeInput}\r\n                                     required\r\n                                     />\r\n                                 }\r\n\r\n                                return<div className=\"mb-3\" key={index}> \r\n                                        <label htmlFor=\"text\" className=\"col-form-label\" style={{ 'textTransform': 'capitalize'}}>{key}</label>\r\n                                            {element}                                            \r\n                                        <div className=\"text-danger form-text\">\r\n                                         {errors[key]?errors[key]:''}\r\n                                        </div>\r\n                                         \r\n                                        <div className=\"invalid-feedback\">\r\n        Please choose a username.\r\n      </div>\r\n                                    </div>\r\n                            })\r\n                        }\r\n                        <div className=\"mb-2 d-flex justify-content-end\">\r\n                            <button type=\"submit\" className=\" ml-auto\" >Save</button>\r\n                        </div>  \r\n                   </form>\r\n\r\n                </div>\r\n                </div>\r\n            </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nModalForm.propTypes={\r\n    modalTitle:PropTypes.string,\r\n    inputData:PropTypes.object,\r\n    onSubmit:PropTypes.func\r\n}\r\n\r\nexport default ModalForm\r\n","\r\nimport PropTypes from 'prop-types'\r\n\r\nconst ModalButton = ({text,onClick,color,modalFormId,className}) => {\r\n\r\n    return (\r\n        <button dangerouslySetInnerHTML={{ __html: text }} onClick={onClick} \r\n                type=\"button\" className={'p-1 '+ className}\r\n                data-bs-toggle=\"modal\" \r\n                data-bs-target={'#'+modalFormId}\r\n                style={{color:color}}>\r\n            {}\r\n        </button>\r\n    )\r\n}\r\n\r\nModalButton.propTypes={\r\n    text:PropTypes.string,\r\n    modalFormId:PropTypes.string,\r\n    color:PropTypes.string,\r\n    width:PropTypes.string,\r\n    onClick:PropTypes.func\r\n}\r\n\r\nexport default ModalButton\r\n"],"sourceRoot":""}